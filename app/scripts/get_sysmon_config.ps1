$sysmonPath = (Get-CimInstance -ClassName Win32_Service -Filter "Name='sysmon'").PathName; if($sysmonPath){$sysmonOutput = & $sysmonPath -c; $configPath = ($sysmonOutput | Select-String "Config file:\s+(.+)").Matches.Groups[1].Value; if($configPath){if(Test-Path $configPath){Get-Content -Path $configPath}else{Write-Error "Config file not found"}}else{Write-Error "Config path not found in output"}}else{Write-Error "Sysmon not found"}